# 运行
使用werkzeug创建一个应用，使用run_simple()运行。
```python

from werkzeug import run_simple

app = None
run_simple('0.0.0.0', 5000, app)
```

# WSGIApplication

必须是一个callable类型。
定义一个类，实现__call__()方法，就是callable类型。

# 最低配置的运行代码
```python

from werkzeug import run_simple, Response

class App:

    def __call__(self, env, start_response):
        resp = Response()
        return resp(env, start_response)
app = App()
run_simple('0.0.0.0', 5000, app)

```

# 返回html内容
```python

from werkzeug import run_simple, Response

class App:

    def __call__(self, env, start_response):
        resp = Response("<strong>hello world</strong>", mimetype='text/html')
        return resp(env, start_response)
app = App()
run_simple('0.0.0.0', 5000, app)
```

# 读取jinja2模板

要使用jinja2，首先创建一个jinja2的environment类的对象。
在类的实例化的时候，需要传入loader的具体值。
```python

import os

import jinja2
from werkzeug import run_simple, Response

class App:
    def __init__(self):
        self.template_folder = os.path.join(os.path.dirname(__file__), 'templates')
        self.jinja_env = jinja2.Environment(loader=jinja2.FileSystemLoader(self.template_folder), autoescape=True)
        print('读取的模板', self.jinja_env.loader.list_templates())

    def __call__(self, env, start_response):
        text = self.jinja_env.get_template('index.html').render()
        resp = Response(text, mimetype='text/html')
        return resp(env, start_response)
    
app = App()
run_simple('0.0.0.0', 5000, app)

```
# 路由

在env变量中，有REQUEST_URI的参数值，是请求的url。根据这个url对应具体的模板名称。这就是路由。
```python

import os
from collections import defaultdict

import jinja2
from werkzeug import run_simple, Response

class App:
    def __init__(self):
        self.template_folder = os.path.join(os.path.dirname(__file__), 'templates')
        self.jinja_env = jinja2.Environment(loader=jinja2.FileSystemLoader(self.template_folder), autoescape=True)
        print('读取的模板', self.jinja_env.loader.list_templates())

    def rule_map(self, path):
        dd = defaultdict(str)
        dd['/']='index.html'
        dd['/user'] = 'user.html'

        template_name = dd.get(path, '')
        return template_name
    
    def __call__(self, env, start_response):
        path = env['REQUEST_URI']
        print('请求路径', path)
        text = self.jinja_env.get_template(self.rule_map(path)).render()
        resp = Response(text, mimetype='text/html')
        return resp(env, start_response)

app = App()
run_simple('0.0.0.0', 5000, app)

```